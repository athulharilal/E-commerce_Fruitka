<!-- product section -->
<div class="product-section mt-80 mb-80">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 offset-lg-2 text-center">
        <div class="section-title">
          <h3><span class="orange-text">Our</span> Products</h3>
          <p><b>The Best Of Nature Straight From Farms</b></p>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-lg-8 mb-4">
        <p></p>
      </div>
      <div class="col-lg-4 mb-4">
        <div class="result-actions">
          <div class="result-sorting">
            <form method="post" action="/filter">
              <div class="row">
                <span>Filter By Category:</span>
                <select class="form-control border-0" id="sort-select" name="selectedValue"
                  onchange="this.form.submit()">
                  <option value="2">Select</option>
                  <option value="All">
                    <a href="#">All</a>
                  </option>
                  <option value="Summer">
                    <a href="#">Summer</a>
                  </option>
                  <option value="Winter">
                    <a href="#">Winter</a>
                  </option>
                  <option value="Monsoon">
                    <a href="#">Monsoon</a>
                  </option>
                  <option value="Spring">
                    <a href="#">Spring</a>
                  </option>
                </select>
              </div>
            </form>
          </div>
        </div>
      </div>
      {{#each data}}
      <div class="col-lg-4 col-md-6 text-center" id="product-list">
        <div class="single-product-item">
          <div id="carousel-{{this._id}}" class="carousel slide" data-ride="carousel">
            <ol class="carousel-indicators">
              {{#each this.images}}
              <li data-target="#carousel-{{../_id}}" data-slide-to="{{@index}}" class="{{#if @first}}active{{/if}}">
              </li>
              {{/each}}
            </ol>
            <div class="carousel-inner">
              {{#each this.images}}
              <div class="carousel-item {{#if @first}}active{{/if}}">
                <a href="/view-products/{{../_id}}">
                  <img class="lazyload" src="/product-images/{{this}}" alt="" />
                </a>
              </div>
              {{/each}}
            </div>
            <a class="carousel-control-prev" href="#carousel-{{this._id}}" role="button" data-slide="prev">
              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
              <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#carousel-{{this._id}}" role="button" data-slide="next">
              <span class="carousel-control-next-icon" aria-hidden="true"></span>
              <span class="sr-only">Next</span>
            </a>
          </div>
          <h3 class="orange-text mt-5">{{this.Name}}</h3>
          <p class="card-text product-price">
            <span class="text-danger">Per Kg</span>
            <s><i class="text-muted">Rs.{{this.Price}}</i></s>
            <b><i class="text-success">Rs.{{this.Offerprice}}</i></b>
          </p>
          <p class="card-text"><b class="text-danger">Stocks Left: {{this.Quantity}}</b></p>
          <div class="d-grid gap-2 d-md-block">
            <button onclick="addToCart('{{this._id}}')" type="button" class="btn btn-sm btn-success">Add To
              Cart</button>
            <button onclick="addToWishlist('{{this._id}}')" type="button" class="btn btn-sm btn-success">Add To
              Wishlist</button>
          </div>
        </div>
      </div>
      {{/each}}
    </div>
    <!-- Assuming you have the necessary data in your template context -->
    {{#if pageCount}}
    <nav class="d-flex justify-content-center">
      <ul class="pagination">
        <li class="page-item custom-active">
          <a class="page-link" href="/?page=1" aria-label="Previous">
            <span aria-hidden="true">&laquo;</span>
          </a>
        </li>
        <li class="page-item custom-page">
          <a class="page-link" href="/?page=1" onclick="highlightPage(event, 1)">1</a>
        </li>
        <li class="page-item custom-page">
          <a class="page-link" href="/?page=2" onclick="highlightPage(event, 2)">2</a>
        </li>
        <li class="page-item custom-page">
          <a class="page-link" href="/?page=3" onclick="highlightPage(event, 3)">3</a>
        </li>
        <li class="page-item custom-active">
          <a class="page-link" href="/?page=1" aria-label="Next">
            <span aria-hidden="true">&raquo;</span>
          </a>
        </li>
      </ul>
    </nav>
    <script>
      function highlightPage(event, pageNumber) {
        event.preventDefault();

        // Remove active class from all page items
        const pageItems = document.querySelectorAll('.page-item.custom-page');
        pageItems.forEach(item => {
          item.classList.remove('active');
        });

        // Add active class to the clicked page item
        const clickedPageItem = event.currentTarget.parentNode;
        clickedPageItem.classList.add('active');

        // Get the current URL and search parameters
        const url = new URL(window.location.href);
        const searchParams = new URLSearchParams(url.search);

        // Update the 'page' parameter with the selected page number
        searchParams.set('page', pageNumber);

        // Update the search parameters in the URL
        url.search = searchParams.toString();

        // Navigate to the updated URL
        window.location.href = url.toString();
      }

      // Remove active class from all page items
      const pageItems = document.querySelectorAll('.page-item.custom-page');
      pageItems.forEach(item => {
        item.classList.remove('active');
      });

      // Add active class to the clicked page item
      const clickedPageItem = event.currentTarget.parentNode;
      clickedPageItem.classList.add('active');
    </script>

    <style>
      .page-item.custom-page.active a.page-link {
        background-color: orange;
        color: white;
      }
    </style>

    {{/if}}
    <style>
      .custom-active .page-link {
        background-color: #F28123;
        color: #fff;
      }

      .custom-page .page-link {
        color: #051922;
      }
    </style>
  </div>
</div>
<!-- end product section -->
<!-- end features list section -->
<!-- shop banner -->
{{#each banners}}
<section class=" " style="position: relative;">
  <a href="#">
    <img src="/product-images/{{this.images.[0]}}" alt="Banner">
  </a>
  <div class="bottom-left" style="position: absolute;  bottom: 8%; left: 5%;">
    <h3>{{this.suBname}} is on!
      <br />
      with big
      <span class="orange-text">Discount...</span></h3>
    <div class="sale-percent"><span>Sale! <br /> Upto</span>{{this.offer}}%
      <span>off</span></div>
    <a href="/" class="cart-btn btn-lg">Shop Now</a>
  </div>
</section>
{{/each}}
<!-- end shop banner -->
<div class="list-section pt-80 pb-80 mb-150 ">
  <div class="container">
    <div class="row">
      <div class="col-lg-4 col-md-6 mb-4 mb-lg-0">
        <div class="list-box d-flex align-items-center">
          <div class="list-icon">
            <i class="fas fa-shipping-fast"></i>
          </div>
          <div class="content">
            <h3>Free Shipping</h3>
            <p>When order over $75</p>
          </div>
        </div>
      </div>
      <div class="col-lg-4 col-md-6 mb-4 mb-lg-0">
        <div class="list-box d-flex align-items-center">
          <div class="list-icon">
            <i class="fas fa-phone-volume"></i>
          </div>
          <div class="content">
            <h3>24/7 Support</h3>
            <p>Get support all day</p>
          </div>
        </div>
      </div>
      <div class="col-lg-4 col-md-6">
        <div class="list-box d-flex justify-content-start align-items-center">
          <div class="list-icon">
            <i class="fas fa-sync"></i>
          </div>
          <div class="content">
            <h3>Refund</h3>
            <p>Get refund within 3 days!</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- advertisement section -->
<div class="abt-section mb-150 mt-150">
  <div class="container">
    <div class="row">
      <div class="col-lg-6 col-md-12">
        <div class="abt-bg">
          <a href="https://www.youtube.com/watch?v=DBLlFWYcIGQ" class="video-play-btn popup-youtube"><i
              class="fas fa-play"></i></a>
        </div>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="abt-text">
          <p class="top-sub">Since Year 1999</p>
          <h2>We are <span class="orange-text">Fruitkha</span></h2>
          <p>Welcome to Fruitika, your go-to online destination for the finest and freshest seasonal fruits. We are
            passionate about providing you with the highest quality fruits straight from the orchards to your doorstep.
            At Fruitika, we believe that nature's bounty should be savored and enjoyed, which is why we handpick the
            best fruits when they are at their peak ripeness and flavor.</p>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- end advertisement section -->
<script>
  < script >
    var countdown = new Countdown(new Date("2022-05-05T00:00:00Z"), function (event) {
      document.getElementById('countdown').innerHTML = event.strftime('%D days %H:%M:%S');
    });
  countdown.start();
</script>
</script>
<script>
  var loading = false;
  var currentPage = 1;
  var maxPages = 10; // or any other limit you prefer
  $(window).scroll(function () {
    if ($(window).scrollTop() + $(window).height() >= $(document).height() - 300) {
      loadMore();
    }
  });

  function loadMore() {
    if (loading || currentPage >= maxPages) {
      return;
    }
    loading = true;
    $.ajax({
      url: '/' + (currentPage + 1),
      type: 'GET',
      success: function (data) {
        $('#product-list').append(data);
        currentPage++;
        loading = false;
      }
    });
  }
</script>
